<%
  chat_group = local_assigns[:chat_group] || 'professionals_only'
%>
<%= form_with model: [:admin, beneficiary, BeneficiaryChatMessage.new],
             url: admin_beneficiary_chat_messages_path(beneficiary),
             method: :post,
             data: {
               action: "turbo:submit-end->chat-form#resetForm"
             },
             class: "flex items-center justify-between gap-3" do |f| %>
    <%= f.hidden_field :chat_group, value: chat_group, id: "chat_group_#{beneficiary.id}" %>
    <div class="relative w-full">
      <%= f.text_area :content,
                    rows: 1,
                    placeholder: "Digite uma mensagem... (Shift+Enter para nova linha)",
                    id: "chat_message_content_textarea_#{beneficiary.id}",
                    class: "w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 pr-12 text-sm text-gray-800 placeholder:text-gray-400 focus:border-brand-300 focus:ring-brand-500/10 focus:outline-none focus:ring-3 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 #{'border-red-500' if message&.errors&.any?}",
                    data: {
                      chat_form_target: "input",
                      controller: "auto-resize"
                    } %>
      <% if message&.errors&.any? %>
        <div class="mt-1 text-xs text-red-500">
          <%= message.errors.full_messages.to_sentence %>
        </div>
      <% end %>
    </div>
    <button type="submit" class="flex h-9 w-9 flex-shrink-0 items-center justify-center rounded-lg bg-brand-500 text-white hover:bg-brand-600 transition">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M4.98481 2.44399C3.11333 1.57147 1.15325 3.46979 1.96543 5.36824L3.82086 9.70527C3.90146 9.89367 3.90146 10.1069 3.82086 10.2953L1.96543 14.6323C1.15326 16.5307 3.11332 18.4291 4.98481 17.5565L16.8184 12.0395C18.5508 11.2319 18.5508 8.76865 16.8184 7.961L4.98481 2.44399ZM3.34453 4.77824C3.0738 4.14543 3.72716 3.51266 4.35099 3.80349L16.1846 9.32051C16.762 9.58973 16.762 10.4108 16.1846 10.68L4.35098 16.197C3.72716 16.4879 3.0738 15.8551 3.34453 15.2223L5.19996 10.8853C5.21944 10.8397 5.23735 10.7937 5.2537 10.7473L9.11784 10.7473C9.53206 10.7473 9.86784 10.4115 9.86784 9.99726C9.86784 9.58304 9.53206 9.24726 9.11784 9.24726L5.25157 9.24726C5.2358 9.20287 5.2186 9.15885 5.19996 9.11528L3.34453 4.77824Z" fill="white"/>
      </svg>
    </button>
<% end %>
