<%= form_with model: (anamnesis.beneficiary.present? ? [:admin, anamnesis.beneficiary, anamnesis] : [:admin, anamnesis]), local: true do |form| %>
  <%= render Alerts::ErrorComponent.new(model: anamnesis, title: "Erro ao salvar anamnese") %>

  <div class="space-y-6">

  <div class="rounded-2xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]">
    <div class="border-b border-gray-200 px-6 py-4 dark:border-gray-800">
      <h2 class="text-lg font-medium text-gray-800 dark:text-white">
        <%= anamnesis.new_record? ? "Nova Anamnese" : "Editar Anamnese" %>
      </h2>
    </div>

    <div class="p-4 sm:p-6 space-y-8">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div>
          <%= form.label :performed_at, "Data Realizada", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.datetime_local_field :performed_at,
              value: anamnesis.performed_at&.strftime("%Y-%m-%dT%H:%M"),
              class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>

        <div>
          <%= form.label :start_time, "Horário de Início", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.time_field :start_time,
              value: anamnesis.start_time&.strftime("%H:%M"),
              class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>

        <div>
          <%= form.label :session_email, "E-mail", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.email_field :session_email,
              class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <%= form.label :professional_id, "Profissional", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.select :professional_id,
              options_from_collection_for_select(
                User.joins(:professional).where(professionals: { active: true }),
                :id, :full_name,
                anamnesis.professional_id || current_user.id
              ),
              { prompt: "Selecione o profissional" },
              { class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" } %>
        </div>

        <div>
          <%= form.label :responsible_doctor, "Médico Responsável", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_field :responsible_doctor,
              class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
      </div>
    </div>
  </div>

  <% if beneficiary.present? %>
    <%= render 'form_section_header', title: 'I - Identificação' do %>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Nome</label>
          <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= beneficiary.name %></p>
        </div>
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">CPF</label>
          <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= beneficiary.cpf %></p>
        </div>
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Data de Nascimento</label>
          <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= beneficiary.birth_date.strftime("%d/%m/%Y") %></p>
        </div>
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Idade</label>
          <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= beneficiary.age %> anos</p>
        </div>
        <div>
          <%= form.label :birthplace, "Naturalidade", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_field :birthplace, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
        <div>
          <%= form.label :birth_state, "Estado", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_field :birth_state, maxlength: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Telefone</label>
          <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= beneficiary.formatted_phone %></p>
        </div>
        <div>
          <%= form.label :religion, "Religião", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_field :religion, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
      </div>
    <% end %>
  <% elsif anamnesis.portal_intake.present? %>
    <%= render 'form_section_header', title: 'I - Identificação (Portal)', subtitle: 'Após preencher e concluir a anamnese, o beneficiário será criado automaticamente.' do %>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Nome</label>
          <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= anamnesis.portal_intake.nome || anamnesis.portal_intake.beneficiary_name %></p>
        </div>
        <% if anamnesis.portal_intake.data_nascimento.present? %>
          <div>
            <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Data de Nascimento</label>
            <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= anamnesis.portal_intake.data_nascimento.strftime("%d/%m/%Y") rescue anamnesis.portal_intake.data_nascimento %></p>
          </div>
        <% end %>
        <% if anamnesis.portal_intake.cpf.present? %>
          <div>
            <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">CPF</label>
            <p class="h-11 w-full rounded-lg border border-gray-300 bg-gray-50 px-4 py-2.5 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"><%= anamnesis.portal_intake.cpf %></p>
          </div>
        <% end %>
        <div>
          <%= form.label :birthplace, "Naturalidade", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_field :birthplace, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
        <div>
          <%= form.label :birth_state, "Estado", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_field :birth_state, maxlength: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
        <div>
          <%= form.label :religion, "Religião", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_field :religion, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
      </div>
    <% end %>
  <% end %>

  <%= render 'form_section_header', title: 'II - Filiação' do %>
    <div class="space-y-8">
      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Pai</h4>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <%= form.label :father_name, "Nome", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :father_name, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div>
            <%= form.label :father_birth_date, "Data de Nascimento", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :father_birth_date, placeholder: "DD/MM/AAAA", data: { controller: "mask", mask_target: "input", mask_type_value: "date" }, value: (form.object.father_birth_date.present? ? form.object.father_birth_date.strftime("%d/%m/%Y") : nil), class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div>
            <%= form.label :father_cpf, "CPF", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :father_cpf, data: { controller: "mask", mask_target: "input", mask_type_value: "cpf" }, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <%= render partial: 'education_field', locals: { form: form, field_name: :father_education, current_value: anamnesis.father_education } %>
          <div>
            <%= form.label :father_profession, "Profissão", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :father_profession, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div>
            <%= form.label :father_workplace, "Local de Trabalho", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :father_workplace, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
        </div>
      </div>

      <div>
        <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4">Mãe</h4>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <%= form.label :mother_name, "Nome", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :mother_name, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div>
            <%= form.label :mother_birth_date, "Data de Nascimento", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :mother_birth_date, placeholder: "DD/MM/AAAA", data: { controller: "mask", mask_target: "input", mask_type_value: "date" }, value: (form.object.mother_birth_date.present? ? form.object.mother_birth_date.strftime("%d/%m/%Y") : nil), class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div>
            <%= form.label :mother_cpf, "CPF", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :mother_cpf, data: { controller: "mask", mask_target: "input", mask_type_value: "cpf" }, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <%= render partial: 'education_field', locals: { form: form, field_name: :mother_education, current_value: anamnesis.mother_education } %>
          <div>
            <%= form.label :mother_profession, "Profissão", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :mother_profession, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div>
            <%= form.label :mother_workplace, "Local de Trabalho", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :mother_workplace, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <%= render 'form_family_composition', form: form, anamnesis: anamnesis %>

  <%= render 'form_referral', form: form, anamnesis: anamnesis %>

  <%= render 'form_gestational', form: form, anamnesis: anamnesis %>

  <%= render 'form_birth', form: form, anamnesis: anamnesis %>

  <%= render 'form_postnatal', form: form, anamnesis: anamnesis %>

  <%= render 'form_feeding', form: form, anamnesis: anamnesis %>

  <%= render 'form_psychomotor', form: form, anamnesis: anamnesis %>

  <%= render 'form_sphincter', form: form, anamnesis: anamnesis %>

  <%= render 'form_language', form: form, anamnesis: anamnesis %>

  <%= render 'form_sleep', form: form, anamnesis: anamnesis %>

  <%= render 'form_social', form: form, anamnesis: anamnesis %>

  <%= render 'form_section_header', title: 'XIII - Escolaridade' do %>
    <div class="space-y-4" data-controller="toggle-fields">
      <div>
        <%= form.label :attends_school, class: "flex items-center gap-2" do %>
          <%= form.check_box :attends_school, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300 rounded", data: { toggle_fields_target: "trigger", action: "change->toggle-fields#update" } %>
          <span class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Frequenta escola?</span>
        <% end %>
      </div>

      <div class="space-y-4" data-toggle-fields-target="content" style="<%= 'display: none;' unless anamnesis.attends_school? %>">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <%= form.label :school_name, "Nome da Escola", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= render Ui::SchoolSearchComponent.new(form: form, field_name: :school_name, placeholder: "Digite o nome da escola para buscar...", value: anamnesis.school_name) %>
          </div>
          <div>
            <%= form.label :school_period, "Período", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.select :school_period, options_for_select([['Selecione...', ''], ['Manhã', 'manha'], ['Tarde', 'tarde'], ['Integral', 'integral']], anamnesis.school_period), {}, { class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" } %>
          </div>
          <div>
            <%= form.label :school_phone, "Telefone", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :school_phone, data: { controller: "mask", mask_target: "input", mask_type_value: "phone" }, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div>
            <%= form.label :school_enrollment_age, "Com que idade ingressou?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
            <%= form.text_field :school_enrollment_age, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
          </div>
          <div class="flex items-center gap-4">
            <span class="text-sm font-medium text-gray-700 dark:text-gray-400">Professor de apoio?</span>
            <div class="flex gap-4">
              <label class="flex items-center gap-1">
                <%= form.radio_button :has_support_teacher, true, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300" %>
                <span class="text-sm">Sim</span>
              </label>
              <label class="flex items-center gap-1">
                <%= form.radio_button :has_support_teacher, false, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300" %>
                <span class="text-sm">Não</span>
              </label>
            </div>
          </div>
        </div>

        <div>
          <%= form.label :after_school_activities, "Mecanismo pedagógico/terapêutico no contra turno?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_area :after_school_activities, rows: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>

        <div>
          <%= form.label :school_difficulties, "Dificuldades encontradas no ambiente escolar?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_area :school_difficulties, rows: 3, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>

        <div>
          <%= form.label :family_school_expectations, "O que a família espera da escola?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
          <%= form.text_area :family_school_expectations, rows: 3, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
        </div>
      </div>
    </div>
  <% end %>

  <%= render 'form_health', form: form, anamnesis: anamnesis %>

  <%= render 'form_general', form: form, anamnesis: anamnesis %>

  <div class="flex flex-col gap-3 sm:flex-row sm:justify-end">
    <%= link_to "Cancelar", admin_anamneses_path, class: "shadow-theme-xs inline-flex items-center justify-center gap-2 rounded-lg bg-white px-4 py-3 text-sm font-medium text-gray-700 ring-1 ring-gray-300 transition hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-400 dark:ring-gray-700 dark:hover:bg-white/[0.03]" %>
    <%= form.submit anamnesis.persisted? ? "Atualizar Anamnese" : "Criar Anamnese", class: "bg-brand-500 shadow-theme-xs hover:bg-brand-600 inline-flex items-center justify-center gap-2 rounded-lg px-4 py-3 text-sm font-medium text-white transition" %>
  </div>
  </div>
<% end %>
