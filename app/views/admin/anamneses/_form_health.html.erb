<%= render 'form_section_header', title: 'XIV - Saúde' do %>
  <div class="space-y-4">
    <div>
      <%= form.label :previous_illnesses, "Quais doenças já teve?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
      <%= form.text_area :previous_illnesses, rows: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-controller="toggle-fields">
      <div class="flex items-center gap-4">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-400">Internações?</span>
        <div class="flex gap-4">
          <label class="flex items-center gap-1">
            <%= form.radio_button :hospitalizations, true, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Sim</span>
          </label>
          <label class="flex items-center gap-1">
            <%= form.radio_button :hospitalizations, false, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Não</span>
          </label>
        </div>
      </div>
      <div data-toggle-fields-target="content" style="<%= 'display: none;' unless anamnesis.hospitalizations %>">
        <%= form.label :hospitalization_causes, "Causas?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
        <%= form.text_area :hospitalization_causes, rows: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-controller="toggle-fields">
      <div class="flex items-center gap-4">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-400">Apresenta epilepsia?</span>
        <div class="flex gap-4">
          <label class="flex items-center gap-1">
            <%= form.radio_button :has_epilepsy, true, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Sim</span>
          </label>
          <label class="flex items-center gap-1">
            <%= form.radio_button :has_epilepsy, false, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Não</span>
          </label>
        </div>
      </div>
      <div data-toggle-fields-target="content" style="<%= 'display: none;' unless anamnesis.has_epilepsy %>">
        <%= form.label :epilepsy_frequency, "Qual frequência?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
        <%= form.text_field :epilepsy_frequency, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
      </div>
    </div>

    <div>
      <%= form.label :current_medications, "Medicamentos usados?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
      <%= form.text_area :current_medications, rows: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <%= form.label :exams_done, "Exames já realizados?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
        <%= form.text_area :exams_done, rows: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
      </div>
      <div>
        <%= form.label :exams_to_do, "Exames a realizar?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
        <%= form.text_area :exams_to_do, rows: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-controller="toggle-fields">
      <div class="flex items-center gap-4">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-400">Tem alergia?</span>
        <div class="flex gap-4">
          <label class="flex items-center gap-1">
            <%= form.radio_button :has_allergies, true, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Sim</span>
          </label>
          <label class="flex items-center gap-1">
            <%= form.radio_button :has_allergies, false, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Não</span>
          </label>
        </div>
      </div>
      <div data-toggle-fields-target="content" style="<%= 'display: none;' unless anamnesis.has_allergies %>">
        <%= form.label :allergies_description, "Quais?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
        <%= form.text_area :allergies_description, rows: 2, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
      </div>
    </div>

    <div>
      <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">Presença de doenças ou deficiências na família</label>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-2">
        <% family_conditions = Anamnesis::FAMILY_CONDITIONS %>
        <% current_conditions = anamnesis.family_conditions_array %>
        <% family_conditions.each do |condition| %>
          <label class="flex items-center gap-2">
            <%= check_box_tag "anamnesis[family_conditions][]", condition[:key], current_conditions.include?(condition[:key]), class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300 rounded" %>
            <span class="text-sm"><%= condition[:label] %></span>
          </label>
        <% end %>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" data-controller="toggle-fields">
      <div class="flex items-center gap-4">
        <span class="text-sm font-medium text-gray-700 dark:text-gray-400">Internações em Hospital Psiquiátrico?</span>
        <div class="flex gap-4">
          <label class="flex items-center gap-1">
            <%= form.radio_button :psychiatric_hospitalization, true, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Sim</span>
          </label>
          <label class="flex items-center gap-1">
            <%= form.radio_button :psychiatric_hospitalization, false, class: "h-4 w-4 text-brand-600 focus:ring-brand-500 border-gray-300", data: { action: "change->toggle-fields#update", toggle_fields_target: "trigger" } %>
            <span class="text-sm">Não</span>
          </label>
        </div>
      </div>
      <div data-toggle-fields-target="content" style="<%= 'display: none;' unless anamnesis.psychiatric_hospitalization %>">
        <%= form.label :psychiatric_hospitalization_who, "Quem?", class: "mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400" %>
        <%= form.text_field :psychiatric_hospitalization_who, class: "dark:bg-dark-900 shadow-theme-xs focus:border-brand-300 focus:ring-brand-500/10 dark:focus:border-brand-800 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 placeholder:text-gray-400 focus:ring-3 focus:outline-hidden dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30" %>
      </div>
    </div>
  </div>
<% end %>


