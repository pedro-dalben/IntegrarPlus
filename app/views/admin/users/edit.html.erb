<div class="page-header d-print-none">
  <div class="container-xl">
    <div class="row g-2 align-items-center">
      <div class="col">
        <h2 class="page-title">
          Editar Usuário: <%= @user.name %>
        </h2>
      </div>
      <div class="col-auto ms-auto d-print-none">
        <div class="btn-list">
          <%= link_to 'Voltar', admin_user_path(@user), class: 'btn btn-outline-secondary' %>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="page-body">
  <div class="container-xl">
    <div class="row row-cards">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Informações do Usuário</h3>
          </div>
          <div class="card-body">
            <%= form_with model: [:admin, @user], local: true do |form| %>
              <% if @user.errors.any? %>
                <div class="alert alert-danger">
                  <h4>Erro ao salvar usuário:</h4>
                  <ul>
                    <% @user.errors.full_messages.each do |message| %>
                      <li><%= message %></li>
                    <% end %>
                  </ul>
                </div>
              <% end %>
              
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <%= form.label :name, 'Nome', class: 'form-label' %>
                    <%= form.text_field :name, class: 'form-control' %>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <%= form.label :email, 'Email', class: 'form-label' %>
                    <%= form.email_field :email, class: 'form-control' %>
                  </div>
                </div>
              </div>
              
              <div class="form-footer">
                <%= form.submit 'Salvar', class: 'btn btn-primary' %>
                <%= link_to 'Cancelar', admin_user_path(@user), class: 'btn btn-outline-secondary' %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Ações</h3>
          </div>
          <div class="card-body">
            <div class="list-group list-group-flush">
              <% if @user.professional&.active? == false %>
                <%= link_to 'Ativar Usuário', activate_admin_user_path(@user), method: :patch, class: 'list-group-item list-group-item-action', data: { confirm: 'Tem certeza que deseja ativar este usuário?' } %>
              <% elsif @user.professional&.active? %>
                <%= link_to 'Desativar Usuário', deactivate_admin_user_path(@user), method: :patch, class: 'list-group-item list-group-item-action text-danger', data: { confirm: 'Tem certeza que deseja desativar este usuário?' } %>
              <% end %>
              
              <%= link_to 'Ver Profissional', admin_professional_path(@user.professional), class: 'list-group-item list-group-item-action' if @user.professional %>
              
              <%= link_to 'Excluir Usuário', admin_user_path(@user), method: :delete, class: 'list-group-item list-group-item-action text-danger', data: { confirm: 'Tem certeza que deseja excluir este usuário? Esta ação não pode ser desfeita.' } %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
