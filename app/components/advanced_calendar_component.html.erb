<div class="advanced-calendar-wrapper">
  <!-- Cabeçalho da Agenda -->
  <div class="flex items-center justify-between mb-6">
    <div class="flex items-center gap-4">
      <!-- Seletor de Visualização -->
      <select data-calendar-views-target="viewSelector" 
          class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        <option value="month">Mês</option>
        <option value="week">Semana</option>
        <option value="day">Dia</option>
      </select>

      <!-- Filtro por Tipo de Evento -->
      <select data-calendar-views-target="eventTypeFilter" 
          class="px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
        <option value="all">Todos os tipos</option>
        <% event_types.each do |type| %>
          <option value="<%= type[:value] %>"><%= type[:label] %></option>
        <% end %>
      </select>
    </div>

    <!-- Botões de Navegação -->
    <div class="flex items-center gap-2">
      <button type="button" 
          class="px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
          data-action="click->calendar-views#prev">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
      </button>
      
      <button type="button" 
          class="px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
          data-action="click->calendar-views#today">
        Hoje
      </button>
      
      <button type="button" 
          class="px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500"
          data-action="click->calendar-views#next">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Calendário Principal -->
  <div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-lg">
    <div id="<%= calendar_id %>" 
        data-controller="calendar-views"
        data-calendar-views-events-data-value="<%= events_data.to_json %>"
        data-calendar-views-read-only-value="<%= read_only %>"
        data-calendar-views-professional-id-value="<%= professional&.id %>"
        data-calendar-views-target="calendar"
        style="min-height: 600px;">
      
      <!-- Visualização Mensal -->
      <div data-calendar-views-target="monthView">
        <div class="month-grid">
          <!-- Conteúdo será inserido via JavaScript -->
        </div>
      </div>

      <!-- Visualização Semanal -->
      <div data-calendar-views-target="weekView" class="hidden">
        <div class="week-grid">
          <!-- Conteúdo será inserido via JavaScript -->
        </div>
      </div>

      <!-- Visualização Diária -->
      <div data-calendar-views-target="dayView" class="hidden">
        <div class="day-grid">
          <!-- Conteúdo será inserido via JavaScript -->
        </div>
      </div>
    </div>
  </div>

  <!-- Legenda de Cores -->
  <div class="mt-6 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4">
    <h4 class="text-sm font-medium text-gray-900 dark:text-white mb-3">Legenda de Eventos</h4>
    <div class="flex flex-wrap gap-3">
      <% event_types.each do |type| %>
        <div class="flex items-center gap-2">
          <div class="w-3 h-3 rounded-full" style="background-color: <%= type[:color] %>"></div>
          <span class="text-sm text-gray-600 dark:text-gray-400"><%= type[:label] %></span>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Lista de Eventos -->
  <% if events_data.any? %>
    <div class="mt-6 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4">
      <h4 class="text-sm font-medium text-gray-900 dark:text-white mb-3">Todos os Eventos</h4>
      <div class="space-y-2">
        <% events_data.each do |event| %>
          <div class="flex items-center gap-3 p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
            <div class="w-3 h-3 rounded-full" style="background-color: <%= event[:color] %>"></div>
            <div class="flex-1">
              <div class="font-medium text-gray-900 dark:text-white"><%= event[:title] %></div>
              <div class="text-sm text-gray-500 dark:text-gray-400">
                <%= Date.parse(event[:start]).strftime("%d/%m às %H:%M") %> - <%= event[:professional_name] %>
              </div>
              <% if event[:description].present? %>
                <div class="text-xs text-gray-400 dark:text-gray-500 mt-1">
                  <%= event[:description] %>
                </div>
              <% end %>
            </div>
            <div class="text-xs px-2 py-1 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400">
              <%= event[:event_type].humanize %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="mt-6 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 text-center">
      <svg class="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
      </svg>
      <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">
        Nenhum evento agendado
      </h3>
      <p class="text-gray-500 dark:text-gray-400">
        Que tal criar um novo evento?
      </p>
    </div>
  <% end %>
</div>

