#!/usr/bin/env ruby
require_relative "../config/environment"

puts "ğŸ” Testando integraÃ§Ã£o com Sentry..."
puts "Ambiente: #{Rails.env}"
puts "DSN configurado: #{Sentry.configuration.dsn.present? ? 'âœ… Sim' : 'âŒ NÃ£o'}"
puts ""

if Sentry.configuration.dsn.present?
  puts "ğŸ“¨ Enviando erro de teste para o Sentry..."

  begin
    1 / 0
  rescue ZeroDivisionError => exception
    Sentry.capture_exception(exception)
    puts "âœ… ExceÃ§Ã£o capturada e enviada"
  end

  puts ""
  puts "ğŸ“¨ Enviando mensagem de teste para o Sentry..."
  Sentry.capture_message("Teste de integraÃ§Ã£o do Sentry - #{Time.current}")
  puts "âœ… Mensagem enviada"

  puts ""
  puts "ğŸ‰ Testes concluÃ­dos!"
  puts "Verifique o dashboard do Sentry em: https://sentry.io/"
  puts ""
  puts "Nota: Os eventos podem levar alguns segundos para aparecer no dashboard."
else
  puts "âŒ DSN do Sentry nÃ£o configurado!"
  puts "Configure a variÃ¡vel de ambiente SENTRY_DSN"
end
