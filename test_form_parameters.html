<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Parâmetros do Formulário</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .debug { background: #f5f5f5; padding: 10px; border-radius: 4px; margin-top: 20px; }
        .debug h3 { margin-top: 0; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <h1>Teste - Parâmetros do Formulário de Profissional</h1>
    
    <form id="testForm" onsubmit="testFormSubmission(event)">
        <div class="form-group">
            <label for="full_name">Nome Completo:</label>
            <input type="text" id="full_name" name="professional[full_name]" value="João Silva" required>
        </div>
        
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="professional[email]" value="joao@teste.com" required>
        </div>
        
        <div class="form-group">
            <label for="cpf">CPF:</label>
            <input type="text" id="cpf" name="professional[cpf]" value="123.456.789-00" required>
        </div>
        
        <div class="form-group">
            <label for="phone">Telefone:</label>
            <input type="text" id="phone" name="professional[phone]" value="(11) 99999-9999">
        </div>
        
        <div class="form-group">
            <label for="active">Ativo:</label>
            <select id="active" name="professional[active]">
                <option value="true">Sim</option>
                <option value="false">Não</option>
            </select>
        </div>
        
        <h3>Endereço Principal</h3>
        <div class="form-group">
            <label for="zip_code">CEP:</label>
            <input type="text" id="zip_code" name="professional[primary_address_attributes][zip_code]" value="01234-567">
        </div>
        
        <div class="form-group">
            <label for="street">Rua:</label>
            <input type="text" id="street" name="professional[primary_address_attributes][street]" value="Rua Teste">
        </div>
        
        <div class="form-group">
            <label for="number">Número:</label>
            <input type="text" id="number" name="professional[primary_address_attributes][number]" value="123">
        </div>
        
        <div class="form-group">
            <label for="neighborhood">Bairro:</label>
            <input type="text" id="neighborhood" name="professional[primary_address_attributes][neighborhood]" value="Centro">
        </div>
        
        <div class="form-group">
            <label for="city">Cidade:</label>
            <input type="text" id="city" name="professional[primary_address_attributes][city]" value="São Paulo">
        </div>
        
        <div class="form-group">
            <label for="state">Estado:</label>
            <select id="state" name="professional[primary_address_attributes][state]">
                <option value="SP">São Paulo</option>
                <option value="RJ">Rio de Janeiro</option>
                <option value="MG">Minas Gerais</option>
            </select>
        </div>
        
        <h3>Grupos</h3>
        <div class="form-group">
            <label for="group_ids">Grupos:</label>
            <select id="group_ids" name="professional[group_ids][]" multiple>
                <option value="1">Grupo 1</option>
                <option value="2">Grupo 2</option>
                <option value="3">Grupo 3</option>
            </select>
        </div>
        
        <h3>Especialidades</h3>
        <div class="form-group">
            <label for="speciality_ids">Especialidades:</label>
            <select id="speciality_ids" name="professional[speciality_ids][]" multiple>
                <option value="1">Especialidade 1</option>
                <option value="2">Especialidade 2</option>
                <option value="3">Especialidade 3</option>
            </select>
        </div>
        
        <h3>Especializações</h3>
        <div class="form-group">
            <label for="specialization_ids">Especializações:</label>
            <select id="specialization_ids" name="professional[specialization_ids][]" multiple>
                <option value="1">Especialização 1</option>
                <option value="2">Especialização 2</option>
                <option value="3">Especialização 3</option>
            </select>
        </div>
        
        <button type="submit">Testar Formulário</button>
    </form>
    
    <div class="debug">
        <h3>Debug - Parâmetros do Formulário:</h3>
        <div id="debug-output"></div>
    </div>

    <script>
        let debugOutput;
        
        document.addEventListener('DOMContentLoaded', () => {
            debugOutput = document.getElementById('debug-output');
        });
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const className = type;
            debugOutput.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            console.log(message);
        }
        
        function testFormSubmission(event) {
            event.preventDefault();
            log('Testando submissão do formulário...', 'info');
            
            const form = event.target;
            const formData = new FormData(form);
            
            // Mostrar todos os campos do formulário
            log('=== CAMPOS DO FORMULÁRIO ===', 'info');
            
            // Campos básicos
            log(`Nome: ${form.full_name.value}`, 'info');
            log(`Email: ${form.email.value}`, 'info');
            log(`CPF: ${form.cpf.value}`, 'info');
            log(`Telefone: ${form.phone.value}`, 'info');
            log(`Ativo: ${form.active.value}`, 'info');
            
            // Endereço
            log(`CEP: ${form.zip_code.value}`, 'info');
            log(`Rua: ${form.street.value}`, 'info');
            log(`Número: ${form.number.value}`, 'info');
            log(`Bairro: ${form.neighborhood.value}`, 'info');
            log(`Cidade: ${form.city.value}`, 'info');
            log(`Estado: ${form.state.value}`, 'info');
            
            // Seleções múltiplas
            const groupIds = Array.from(form.group_ids.selectedOptions).map(opt => opt.value);
            const specialityIds = Array.from(form.speciality_ids.selectedOptions).map(opt => opt.value);
            const specializationIds = Array.from(form.specialization_ids.selectedOptions).map(opt => opt.value);
            
            log(`Grupos selecionados: ${groupIds.join(', ')}`, 'info');
            log(`Especialidades selecionadas: ${specialityIds.join(', ')}`, 'info');
            log(`Especializações selecionadas: ${specializationIds.join(', ')}`, 'info');
            
            // Simular parâmetros que seriam enviados
            const simulatedParams = {
                professional: {
                    full_name: form.full_name.value,
                    email: form.email.value,
                    cpf: form.cpf.value,
                    phone: form.phone.value,
                    active: form.active.value,
                    primary_address_attributes: {
                        zip_code: form.zip_code.value,
                        street: form.street.value,
                        number: form.number.value,
                        neighborhood: form.neighborhood.value,
                        city: form.city.value,
                        state: form.state.value
                    },
                    group_ids: groupIds,
                    speciality_ids: specialityIds,
                    specialization_ids: specializationIds
                }
            };
            
            log('=== PARÂMETROS SIMULADOS ===', 'success');
            log(JSON.stringify(simulatedParams, null, 2), 'success');
            
            // Verificar se há campos vazios
            const requiredFields = ['full_name', 'email', 'cpf', 'zip_code', 'street', 'neighborhood', 'city', 'state'];
            const emptyFields = requiredFields.filter(field => {
                const element = form[field];
                return element && element.value.trim() === '';
            });
            
            if (emptyFields.length > 0) {
                log(`⚠️ Campos obrigatórios vazios: ${emptyFields.join(', ')}`, 'error');
            } else {
                log('✅ Todos os campos obrigatórios estão preenchidos', 'success');
            }
            
            // Verificar se há seleções
            if (groupIds.length === 0) {
                log('⚠️ Nenhum grupo selecionado', 'error');
            }
            
            if (specialityIds.length === 0) {
                log('⚠️ Nenhuma especialidade selecionada', 'error');
            }
            
            if (specializationIds.length === 0) {
                log('⚠️ Nenhuma especialização selecionada', 'error');
            }
            
            log('=== TESTE CONCLUÍDO ===', 'info');
        }
        
        // Adicionar listeners para mudanças
        document.addEventListener('change', (event) => {
            if (event.target.multiple) {
                const selectedOptions = Array.from(event.target.selectedOptions).map(opt => opt.text);
                log(`Campo "${event.target.name}" alterado: ${selectedOptions.join(', ')}`, 'info');
            } else {
                log(`Campo "${event.target.name}" alterado: ${event.target.value}`, 'info');
            }
        });
    </script>
</body>
</html>
